/* Form */
form {
  overflow: auto;
  padding: 1rem;
  border-radius: var(--bd-radius);
  margin: 0 auto 1rem;
  background: var(--bg-muted);
}

/* Specificity 0,1,1 to 0,0,0 */ 
:where(form:last-child, label:last-child) {
  margin-bottom: 0;
}

/* Specificity 0,0,2 to 0,0,1
It refers to a inner children, if the specificity is reduced
further it may collide with CSS resets
*/ 
form :where(code) {
  background: var(--bg-subtle);
}

/* Fieldset */
fieldset {
  padding: .5rem 1rem;
  border: 2px solid var(--bd-muted);
  border-radius: var(--bd-radius);
  margin-bottom: 1rem;
}

legend {
  padding: 0 .5rem;
  font-weight: 600;
}

/* Label */
label {
  position: relative;
  display: table;
  margin: 0 0 1rem;
}

/* Specificity 0,0,2 to 0,0,1
It refers to a inner children, if the specificity is reduced
further it may collide with CSS resets
*/ 
label > :where(small) {
  color: var(--muted);
}

/* Specificity 0,1,3 to 0,0,2
Since :where does't support `::before` and `::after`, it
couldn't be reduced further
*/ 
label > :where(small:first-child)::after,
label > :where(small:first-child)::before {
  content: "\A";
  white-space: pre;
}

/* Specificity 0,0,2 to 0,0,1 */ 
label:has(> :where(input, textarea, button)) {
  cursor: pointer;
}

/* Specificity 0,1,2 to 0,1,1
IMHO pseudoclasses must preserve higher specificity
*/ 
label:has(> :where(input, textarea, select, button):disabled) {
  color: var(--muted);
  cursor: not-allowed;
}

/* Specificity 0,1,3 to 0,1,2
IMHO pseudoclasses must preserve higher specificity
*/ 
label:has(> :where(input, textarea, select):required)::before {
  position: absolute;
  left: -.6rem;
  color: var(--danger);
  content: "*";
}

/* Specificity 0,0,2 to 0,0,1
It refers to a inner children, if the specificity is reduced
further it may collide with CSS resets
*/ 
label:has(> :where(textarea)) {
  display: block;
}

/* Generic input */
input, select, textarea, button {
  display: block;
  box-sizing: border-box;
  border: 1px solid var(--bd-muted);
  border-radius: var(--bd-radius);
  margin-top: .25rem;
  background: var(--bg-default);
  color: inherit;
  cursor: pointer;
  font-family: inherit;
  font-size: inherit;
  line-height: 1.5;
  transition: border-color var(--tr-duration);
}

input, select, textarea {
  width: 100%;
}

/* Text area */
textarea {
  width: calc(100% - 1rem);
  padding: .5rem;
  appearance: none;
  cursor: text;
  resize: none;
}

/* Specificity 0,1,1 to 0,1,0 */ 
:where(textarea, select):hover {
  border-color: var(--accent);
}

/* Specificity 0,1,1 to 0,1,0 */ 
:where(input, textarea, select):disabled {
  background-color: var(--bg-muted);
  cursor: not-allowed;
}

/* Select */
select {
  width: 100%;
  padding: .35rem .5rem;
  text-transform: none;
}

/* Input */
input {
  appearance: none;
}

/* Specificity 0,2,1 to 0,1,0 */ 
:where(input:not(:disabled)):hover {
  border-color: var(--accent);
}

/* Specificity 0,1,1 to 0,0,1 */ 
input:where(:not([type="radio"],[type="checkbox"])) {
  position: relative;
  min-height: 1.5rem;
  padding: .25rem .5rem;
}

/* Specificity 0,1,1 to 0,0,1 */ 
input:where([type="radio"],[type="checkbox"]), input:where([type="checkbox"])::before {
  display: inline-block;
  width: 1rem;
  height: 1rem;
  margin: 0 .25rem;
  vertical-align: middle;
}

/* Specificity 0,1,1 to 0,0,1 */
input:where([type="checkbox"]) {
  border-radius: 0;
}

/* Specificity 0,1,1 to 0,0,1 */
input:where([type="radio"]) {
  border-width: 2px;
  border-radius: 50%;
}

/* Specificity 0,2,1 to 0,1,1 */
input:where([type="radio"]):checked {
  border-width: .25rem;
  border-color: var(--accent);
}

/* Specificity 0,2,1 to 0,1,1 */
input:where([type="checkbox"]):checked {
  border-color: var(--accent);
  background: var(--accent);
}

/* Specificity 0,2,2 to 0,1,2 */
input:where([type="checkbox"]):checked::before {
  position: absolute;
  margin: 0;
  background: var(--light);
  content: "";
  mask: center center / 75% no-repeat;
  mask-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIiIGhlaWdodD0iOSIgdmlld0JveD0iMCAwIDEyIDkiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTEuNzgwMyAwLjIxOTYyNUMxMS45MjEgMC4zNjA0MjcgMTIgMC41NTEzMDUgMTIgMC43NTAzMTNDMTIgMC45NDkzMjEgMTEuOTIxIDEuMTQwMTkgMTEuNzgwMyAxLjI4MUw0LjUxODYgOC41NDA0MkM0LjM3Nzc1IDguNjgxIDQuMTg2ODIgOC43NiAzLjk4Nzc0IDguNzZDMy43ODg2NyA4Ljc2IDMuNTk3NzMgOC42ODEgMy40NTY4OSA4LjU0MDQyTDAuMjAxNjIyIDUuMjg2MkMwLjA2ODkyNzcgNS4xNDM4MyAtMC4wMDMzMDkwNSA0Ljk1NTU1IDAuMDAwMTE2NDkzIDQuNzYwOThDMC4wMDM1NTIwNSA0LjU2NjQzIDAuMDgyMzg5NCA0LjM4MDgxIDAuMjIwMDMyIDQuMjQzMjFDMC4zNTc2NjUgNC4xMDU2MiAwLjU0MzM1NSA0LjAyNjgxIDAuNzM3OTcgNC4wMjMzOEMwLjkzMjU4NCA0LjAxOTk0IDEuMTIwOTMgNC4wOTIxNyAxLjI2MzM0IDQuMjI0ODJMMy45ODc3NCA2Ljk0ODM1TDEwLjcxODYgMC4yMTk2MjVDMTAuODU5NSAwLjA3ODk5MjMgMTEuMDUwNCAwIDExLjI0OTUgMEMxMS40NDg1IDAgMTEuNjM5NSAwLjA3ODk5MjMgMTEuNzgwMyAwLjIxOTYyNVoiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPgo=");
}

/* Specificity 0,2,1 to 0,1,1 */
input:where([type="radio"],[type="checkbox"]):disabled {
  background-color: var(--bd-muted);
}

/* Specificity 0,2,1 to 0,1,1 */
input:where([type="checkbox"]):disabled {
  border-color: transparent;
}

/* Specificity 0,1,1 to 0,0,1 */
input:where([type="range"]) {
  height: .5rem;
  border: transparent;
  margin: .75rem 0;
  accent-color: var(--accent);
  appearance: auto;
  background: var(--bg-subtle);
}

/* Specificity 0,1,2 to 0,0,2 */
input:where([type="file"])::file-selector-button {
  border: 1px solid var(--bd-muted);
  border-radius: var(--bd-radius);
  background: transparent;
  color: var(--accent);
  font: inherit;
}

/* Specificity 0,2,2 to 0,1,2
IMHO pseudoclasses must preserve higher specificity
*/
input:where([type="file"]):hover::file-selector-button {
  background: var(--accent);
  color: var(--light);
}

/* Buttons */
/* Specificity 0,1,1 to 0,0,1 */
button, input:where([type="submit"],[type="reset"],[type="button"],[type="image"]) {
  display: inline-block;
  padding: .25rem .75rem;
  margin: .25rem .125rem;
  background: transparent;
  color: var(--accent);
  text-transform: none;
  transition: background var(--tr-duration), color var(--tr-duration), filter var(--tr-duration);
}

/* Specificity 0,1,1 to 0,0,1 */
input:where([type="image"],[type="file"],[type="color"]) {
  padding: .25rem;
}

/* Specificity 0,2,1 to 0,1,1 */
:is(button, input:where([type="submit"],[type="reset"],[type="button"],[type="image"])):disabled {
  cursor: not-allowed;
  opacity: .5;
}

/* Specificity 0,1,1 to 0,0,1 */
:is(button, input):where([type="reset"]) {
  color: var(--danger);
}

/* Specificity 0,3,1 to 0,1,0 */
:where(button:not(:disabled)):active,
:where(input:is([type="submit"],[type="reset"],[type="button"],[type="image"]):not(:disabled)):active {
  filter: brightness(80%);
}

/* Specificity 0,2,1 to 0,1,0 */
:where(button[type]):not([type="button"]),
input:where([type="submit"],[type="reset"]) {
  border-color: currentColor;
}

/* Specificity 0,3,1 to 0,1,0 */
:where(:is(button, input:is([type="submit"],[type="reset"],[type="button"],[type="image"])):not(:disabled)):hover,
:where(:is(button, input:is([type="submit"],[type="reset"],[type="button"],[type="image"])):not(:disabled)):active {
  border-color: transparent;
  background: var(--accent);
  color: var(--light);
}

/* Specificity 0,3,1 to 0,1,0 */
:where(button, input)[type="reset"]:where(:not(:disabled):active, :not(:disabled):hover) {
  border-color: transparent;
  background: var(--danger);
  color: var(--light);
}
